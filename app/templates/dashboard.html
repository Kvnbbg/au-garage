{% extends 'base.html' %}

{% block title %}Dashboard - {{ super() }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Welcome to your Dashboard, {{ current_user.username }}!</h2>
    {% if user_role %}
        <p>Your Role: {{ user_role.name }} {% if user_role.hashtag %}<span class="badge badge-info">{{ user_role.hashtag }}</span>{% endif %}</p>
        <hr>
        <h4>Role-Specific Options:</h4>
        <ul class="list-group mb-4">
            {% if user_role.name == 'Admin' %}
                <li class="list-group-item"><a href="#">User Management</a></li>
                <li class="list-group-item"><a href="#">Site Configuration</a></li>
                <li class="list-group-item"><a href="#">View All Activity Logs</a></li>
            {% elif user_role.name == 'Maintenance' %}
                <li class="list-group-item"><a href="#">View System Logs</a></li>
                <li class="list-group-item"><a href="#">Application Health Check</a></li>
                <li class="list-group-item"><a href="#">Manage Maintenance Tasks</a></li>
            {% elif user_role.name == 'Worker' %}
                <li class="list-group-item"><a href="#">My Schedule</a></li>
                <li class="list-group-item"><a href="#">View My Tasks</a></li>
                <li class="list-group-item"><a href="#">My Timesheets/Salary Info</a></li>
                <li class="list-group-item"><a href="#">Access Documents</a></li>
            {% elif user_role.name == 'Client' %}
                <li class="list-group-item"><a href="#">View My Orders/Services</a></li>
                <li class="list-group-item"><a href="{{ url_for('auth.profile') }}">My Profile Settings</a></li>
            {% endif %}
            {# Common link - example, could be more specific if a route exists #}
            <li class="list-group-item"><a href="{{ url_for('main.home') }}#social">Social Networking Page (Placeholder)</a></li>
        </ul>
        <hr>
    {% else %}
        <p>You do not have a specific role assigned.</p>
    {% endif %}
</div>

{# Existing complex theme structure below - retained but commented out for brevity in this example #}
<!--
<div class="container my-5">
  <div id="character"></div>
  <div id="car"></div>
</div>
<div class="container my-5">
  <div class="row">
    <div class="col-md-6">
      <div id="movableDiv" class="card p-3" style="position: absolute">
        <h3 class="text-center">Countdown Timer</h3>
        <p class="text-center" id="countdownTimer">34 seconds</p>
      </div>
    </div>
  </div>
</div>
<div
  class="app-container app-theme-white body-tabs-shadow fixed-sidebar fixed-header"
>
  <div class="app-header header-shadow">
    <div class="app-header__logo">
        ... (rest of the original complex template structure) ...
    </div>
  </div>
</div>
-->
<script>
  // Minimal script retained from original for countdown if needed,
  // but most of the complex theme's JS might not be relevant for this simplified view.
  document.addEventListener("DOMContentLoaded", function () {
    const movableDiv = document.getElementById("movableDiv");
    if (movableDiv) { // Check if element exists
        let isDragging = false;
        let countdownStarted = false;

        movableDiv.style.cursor = "pointer";
        movableDiv.title = "Click to start the countdown!";

        centerDiv();

        function enableDrag() {
          movableDiv.addEventListener("mousedown", function (e) {
            if (countdownStarted) {
              isDragging = true;
              let prevX = e.clientX;
              let prevY = e.clientY;

              window.addEventListener("mousemove", move);
              window.addEventListener("mouseup", () => {
                window.removeEventListener("mousemove", move);
                isDragging = false;
              });

              function move(e) {
                if (!isDragging) return;
                let newX = prevX - e.clientX;
                let newY = prevY - e.clientY;

                const rect = movableDiv.getBoundingClientRect();
                movableDiv.style.left = rect.left - newX + "px";
                movableDiv.style.top = rect.top - newY + "px";

                prevX = e.clientX;
                prevY = e.clientY;
              }
            }
          });
        }

        movableDiv.addEventListener("click", function () {
          if (!countdownStarted) {
            startCountdown();
            countdownStarted = true;
            enableDrag();
            this.style.cursor = "grab";
          } else {
            moveToRandomPosition();
          }
        });

        function moveToRandomPosition() {
          const maxX = window.innerWidth - movableDiv.offsetWidth;
          const maxY = window.innerHeight - movableDiv.offsetHeight;
          const randomX = Math.floor(Math.random() * maxX);
          const randomY = Math.floor(Math.random() * maxY);
          movableDiv.style.left = randomX + "px";
          movableDiv.style.top = randomY + "px";
        }

        function centerDiv() {
          const x = (window.innerWidth - movableDiv.offsetWidth) / 2;
          const y = (window.innerHeight - movableDiv.offsetHeight) / 2;
          movableDiv.style.left = `${x}px`;
          movableDiv.style.top = `${y}px`;
        }

        window.addEventListener("resize", centerDiv);

        const countdownDuration = 34;

        function startCountdown() {
          let timeRemaining = countdownDuration;
          updateTimerDisplay(timeRemaining);

          const timeout = setInterval(() => {
            timeRemaining--;
            updateTimerDisplay(timeRemaining);

            if (timeRemaining <= 1) {
              window.location.reload(true);
              clearInterval(timeout);
            }
          }, 1000);
        }

        const countdownTimerEl = document.getElementById("countdownTimer");
        const characterEl = document.getElementById("character");
        const carEl = document.getElementById("car");

        function updateTimerDisplay(time) {
          if (countdownTimerEl) {
            countdownTimerEl.textContent = `${time} second${time !== 1 ? "s" : ""}`;
          }
          // These might not exist in the simplified version, so check
          if (characterEl) characterEl.style.animationDuration = `${time}s`;
          if (carEl) carEl.style.animationDuration = `${time}s`;
        }
    } // end if(movableDiv)
  });
</script>

{% endblock %}
